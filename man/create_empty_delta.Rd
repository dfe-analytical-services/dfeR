% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write_df_to_delta_utils.R
\name{create_empty_delta}
\alias{create_empty_delta}
\title{Create or Replace a Delta Table in Databricks}
\usage{
create_empty_delta(df_or_schema, target_table, db_conn)
}
\arguments{
\item{df_or_schema}{An R data frame or an Arrow \code{Schema} object whose
structure defines the schema of the Delta table.}

\item{target_table}{A character string specifying the name of the Delta
table. Can be unqualified (\code{"table"}), partially qualified
(\code{"schema.table"}), or fully qualified (\code{"catalog.schema.table"}). If not
fully qualified, the function resolves the catalog and/or schema from the
active database connection.}

\item{db_conn}{A DBI database connection object to Databricks.}
}
\value{
None. The function executes the SQL statement to create or replace
the Delta table.
}
\description{
This function generates and executes a \verb{CREATE OR REPLACE TABLE} SQL
statement in Databricks, using the schema inferred from either an R data
frame or an Arrow schema. The resulting table is stored in Delta Lake format.
}
\details{
The function automatically maps column types from R or Arrow to appropriate
Spark SQL types:
\itemize{
\item \strong{R types}: \code{integer} → INT, \code{integer64} → BIGINT,
\code{numeric} → DOUBLE, \code{character/factor} → STRING,
\code{logical} → BOOLEAN, \code{Date} → DATE,
\code{POSIXct/POSIXlt} → TIMESTAMP or TIMESTAMP_NTZ.
\item \strong{Arrow types}: int8/int16 → TINYINT/SMALLINT, int32/int64 → INT/BIGINT,
float/double → FLOAT/DOUBLE, string/large_string → STRING,
bool → BOOLEAN, \code{date32[day]} → DATE,
\code{timestamp[...]} → TIMESTAMP/TIMESTAMP_NTZ,
decimal(P,S) → DECIMAL(P,S).
}

Timestamps are mapped to either \code{TIMESTAMP_NTZ} (no timezone) or \code{TIMESTAMP}
(with timezone). Unsupported types fall back to \code{STRING}.
}
\examples{
\dontrun{
# Using a data frame
con <- DBI::dbConnect(odbc::databricks(),
  httpPath = Sys.getenv("DATABRICKS_SQL_PATH")
)
df <- data.frame(
  id = 1:5,
  name = letters[1:5],
  score = c(9.5, 8.3, 7.2, 6.8, 9.0)
)
create_empty_delta(df, "catalog.schema.my_table", con)

# Using an Arrow schema
library(arrow)
schema_example <- schema(
  id = int32(),
  name = utf8(),
  score = float32()
)
create_empty_delta(schema_example, "catalog.schema.my_arrow_table", con)
}

}
\keyword{internal}
